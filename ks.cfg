# Generated by Anaconda 34.25.1.14
# Generated by pykickstart v3.32
#version=RHEL9
# Use graphical install
graphical
repo --name="AppStream" --baseurl=file:///run/install/sources/mount-0000-cdrom/AppStream

%addon com_redhat_kdump --disable

%end

# Keyboard layouts
keyboard --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=static --device=ens192 --gateway=192.168.1.1 --ip=192.168.1.101 --nameserver=192.168.1.1 --netmask=255.255.255.0 --noipv6 --activate
network  --hostname=Rocky9

# Use CDROM installation media
cdrom

%packages
@^minimal-environment
vim
wget
#kexec-tools
%end

skipx
# Run the Setup Agent on first boot
firstboot --disable
selinux --disabled

# Generated using Blivet version 3.4.0
ignoredisk --only-use=sda
# Partition clearing information
clearpart --drives=sda --all --initlabel
# Disk partitioning information
#part /boot --fstype="xfs" --size=1024
#part /home --fstype="xfs" --size=9214
#part / --fstype="xfs" --size=29696
part / --fstype="xfs" --size=39934


timesource --ntp-disable
# System timezone
timezone Asia/Taipei --utc

# Root password
rootpw --iscrypted --allow-ssh $6$/RpPO/TWgHzEsl7L$6dXIg6Sy7AjhW0MjLX6fiVR6TwunHoUvvQRcf5nqsMaM2uUJNNke0eVzJlQSXP8Uq50mNuAfp4sKUnXBgahAX1
user --name=user --password=$6$KqsSaQbyjJh5jm78$uo/zp3lPlFMKR9DwcPWQL//oAllqNOZg7dHq.YMgUBYjzqnqw/7DNsOMNlZCHw6z6.tD2t.QNm7E4EzR224uG0 --iscrypted --gecos="user"

#reboot --kexec
#reboot


# upgrade the system before rebooting
%post
#yum update -y
#yum install -y open-vm-tools
#yum install -y epel-release vim bind-utils nfs-utils telnet wget ntpdate rsync mlocate glibc libgcc unzip
/bin/echo "net.ipv6.conf.all.disable_ipv6 = 1" >>  /etc/sysctl.conf
/bin/echo "net.ipv6.conf.default.disable_ipv6 = 1" >>  /etc/sysctl.conf

# sshd
/bin/echo 'UseDNS no' >> /etc/ssh/sshd_config
#no supported authentication methods available!
#change PasswordAuthentication no >> yes . or #
# sed PasswordAuthentication no

# swap
dd if=/dev/zero of=/swapfile bs=1024 count=2048000
mkswap /swapfile
swapon /swapfile
/bin/echo "/swapfile swap       swap    defaults        0 0" >> /etc/fstab

#yum clean all

%end
